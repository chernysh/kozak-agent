# Kozak Agent

Агент для моніторингу: працює локально на сервері, збирає перевірки (SSH, Postgres, MySQL, Nginx тощо) та відправляє результати на бекенд моніторингу по WebSocket.

- **Python 3.12+**, asyncio
- Конфігурація через `.env`
- Модульна структура: один модуль — один тип перевірки

## Швидкий старт

1. Скопіюй конфіг і при потребі відредагуй:
   ```bash
   cp .env.example .env
   ```

2. Запуск через Docker Compose (агент + фейковий моніторинг):
   ```bash
   docker compose up --build
   ```

3. У консолі сервісу `mock-monitoring` будуть виводитися всі повідомлення, які агент відправляє по WebSocket.

4. При зміні коду агента контейнер перезапускається автоматично (watchdog).

## Склад

- **agent** — основний додаток: цикл перевірок, відправка на моніторинг, модулі (SSH, Postgres, MySQL, Nginx).
- **mock_monitoring** — WebSocket-сервер для розробки: приймає повідомлення та виводить їх у консоль.

## Конфігурація (.env)

| Змінна | Опис |
|--------|------|
| `MONITORING_URL` | WebSocket URL моніторингу (за замовчуванням `ws://mock-monitoring:8765` у compose) |
| `MONITORING_API_KEY` | API ключ для авторизації |
| `ENABLED_MODULES` | Список модулів через кому: `ssh`, `postgres`, `mysql`, `nginx` |
| `CHECK_INTERVAL` | Інтервал перевірок у секундах |

Для кожного модуля — свої змінні (див. `.env.example`).

## Розробка

- План робіт і деталі реалізації: **[roadmap.md](roadmap.md)**.
- Запуск агента локально (без Docker): з каталогу `agent` встанови залежності та запусти `python main.py`; для SSH перевірки потрібен доступ до хоста з `.env` (наприклад, `SSH_HOST=localhost`).

## Ліцензія

Див. [LICENSE](LICENSE).
